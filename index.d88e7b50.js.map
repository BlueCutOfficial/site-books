{"mappings":"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","sources":["js/utils/what-to-read.js","js/utils/generics.js","node_modules/@parcel/runtime-js/lib/runtime-64a0feadecdee571.js","node_modules/@parcel/runtime-js/lib/runtime-db8a1e637c00f264.js","js/adr-question.js"],"sourcesContent":["import { select } from './generics'\n\nconst questions = [{\n  id: 'size',\n  label: 'Plutôt roman court ou roman plus long ?',\n  choices: [{\n    id: 'short',\n    label: 'Plutôt court.',\n    score: { suzuha: 3, ede: 0, vdy: 0 }\n  }, {\n    id: 'long',\n    label: 'Histoire qui dure.',\n    score: { suzuha: 0, ede: 2, vdy: 2 }\n  }, {\n    id: 'no-size-preference',\n    label: 'C\\'est pas la taille qui compte.',\n    score: { suzuha: 0, ede: 0, vdy: 0 }\n  }]\n}, {\n  id: 'pace',\n  label: 'Quel rythme de lecture recherchez-vous ? Êtes-vous dans l\\'action ou dans la contemplation ?',\n  choices: [{\n    id: 'fast',\n    label: 'J\\'aime quand les événements s\\'enchainent rapidement.',\n    score: { suzuha: 3, ede: 3, vdy: 1 }\n  }, {\n    id: 'slow',\n    label: 'Je veux m\\'imprégner de l\\'ambiance avec de belles descriptions.',\n    score: { suzuha: 1, ede: 2, vdy: 3 }\n  }, {\n    id: 'middle',\n    label: 'Tout est dans l\\'équilibre.',\n    score: { suzuha: 1, ede: 3, vdy: 2 }\n  }]\n}, {\n  id: 'time',\n  label: 'Quel temps de narration préférez-vous ?',\n  choices: [{\n    id: 'present',\n    label: 'Présent',\n    score: { suzuha: 3, ede: 3, vdy: 0 }\n  }, {\n    id: 'past',\n    label: 'Passé',\n    score: { suzuha: 0, ede: 0, vdy: 3 }\n  }, {\n    id: 'no-time-preference',\n    label: 'Aucune importance, tant que le style m\\'emporte.',\n    score: { suzuha: 0, ede: 0, vdy: 0 }\n  }]\n}, {\n  id: 'affinity',\n  label: 'Y a-t-il un élément du cercle de la magie qui vous inspire particulièrement ?',\n  choices: [{\n    id: 'water',\n    label: 'Eau',\n    score: { suzuha: 3, ede: 2, vdy: 0 }\n  }, {\n    id: 'light',\n    label: 'Lumière',\n    score: { suzuha: 0, ede: 3, vdy: 3 }\n  }, {\n    id: 'darkness',\n    label: 'Ombre',\n    score: { suzuha: 0, ede: 3, vdy: 0 }\n  }]\n}, {\n  id: 'theme',\n  label: 'Parmi les thématiques suivantes, laquelle vous parle le plus ?',\n  choices: [{\n    id: 'feminism',\n    label: 'Féminisme',\n    score: { suzuha: 3, ede: 1, vdy: 1 }\n  }, {\n    id: 'journey',\n    label: 'Voyage',\n    score: { suzuha: 1, ede: 3, vdy: 1 }\n  }, {\n    id: 'culture-shock',\n    label: 'Choc des cultures',\n    score: { suzuha: 1, ede: 2, vdy: 3 }\n  }]\n}, {\n  id: 'character',\n  label: 'Quel genre de personnage avez-vous envie de suivre ?',\n  choices: [{\n    id: 'heros',\n    label: 'Une héroïne dans la pure tradition, gentille, courageuse et travailleuse.',\n    score: { suzuha: 3, ede: 0, vdy: 0 }\n  }, {\n    id: 'dark-man',\n    label: 'Un jeune homme qui a ses défauts et un lourd passé.',\n    score: { suzuha: 0, ede: 1, vdy: 3 }\n  }, {\n    id: 'duo',\n    label: 'Et pourquoi pas deux personnages dont les chemins vont se croiser ?',\n    score: { suzuha: 0, ede: 3, vdy: 0 }\n  }]\n}, {\n  id: 'pet',\n  label: 'Le compagnon idéal du rôdeur qui est en vous ?',\n  choices: [{\n    id: 'squirrel',\n    label: 'Un écureuil',\n    score: { suzuha: 0, ede: 3, vdy: 0 }\n  }, {\n    id: 'dragon-tiger',\n    label: 'Un GROS félin',\n    score: { suzuha: 3, ede: 0, vdy: 0 }\n  }, {\n    id: 'no-animal',\n    label: 'Je préfère les arbres aux animaux.',\n    score: { suzuha: 0, ede: 0, vdy: 3 }\n  }]\n}]\n\nexport function setupQuestions() {\n  // Set up the list of questions in a random order\n  window.questions = questions.sort(() => Math.random() - 0.5);\n  let adrQuestionNumberElement = select('wtr-question-number')\n  adrQuestionNumberElement.setAttribute('questions-length', window.questions.length)\n  // Initialize the current question\n  _showQuestion()\n  // Bind the next question function to the next question button's click\n  let nextQuestionButton = select('wtr-button-next')\n  nextQuestionButton.addEventListener('click', _nextQuestion)\n}\n\nexport function updateAnswer(value) {\n  window.selectedAnswer = value \n  _computeTmpScore()\n}\n\n/*\n * Return the structure of the current question, based on \"window.questionIndex\"\n */\nfunction _getQuestion() {\n  return window.questionIndex < window.questions.length \n    ? window.questions[window.questionIndex]\n    : undefined\n}\n\n/*\n * Update the temporay score \"window.tmpScore\".\n * It is the sum of the actual score and the current question score.\n * It should be updated each time the selected answer changes.\n */\nfunction _computeTmpScore() {\n  // Compute the temporary score from actual score and current question\n  let questionScore = _getQuestion().choices.find(({ id }) => {\n    return id === window.selectedAnswer\n  }).score\n  for (let [key] of Object.entries(window.tmpScore)) {\n    window.tmpScore[key] = window.score[key] + questionScore[key]\n  }\n  // Update the result list order\n  let resultListElement = select('wtr-result')\n  resultListElement.setAttribute('score', JSON.stringify(window.tmpScore))\n}\n\n/*\n * Update the question component attributes to display the current question.\n */\nfunction _showQuestion() {\n  // Initialize the selected answer and the temporary score \n  window.selectedAnswer = _getQuestion().choices[0].id\n  _computeTmpScore()\n  // Select the question component in the DOM\n  let adrQuestionElement = select('wtr-question')\n  // It needs the question structure\n  adrQuestionElement.setAttribute('question', JSON.stringify(_getQuestion()))\n  // Display the question number\n  let adrQuestionNumberElement = select('wtr-question-number')\n  adrQuestionNumberElement.setAttribute('question-index', window.questionIndex+1)\n}\n\nfunction _nextQuestion() {\n  // Finalize current score\n  Object.assign(window.score, { ...window.tmpScore })\n  // Show next question\n  window.questionIndex++\n  if (_getQuestion()) {\n    _showQuestion()\n  }\n  // If the last question is reached, change the button text, then hide all\n  if (window.questionIndex === window.questions.length-1) {\n    let nextQuestionButton = select('wtr-button-next')\n    nextQuestionButton.innerHTML = 'Valider'\n  } else if (window.questionIndex === window.questions.length) {\n    let nextQuestionButton = select('wtr-button-next')\n    nextQuestionButton.setAttribute('hidden', true)\n    let adrQuestionElement = select('wtr-question')\n    adrQuestionElement.setAttribute('hidden', true)\n    let adrQuestionNumberElement = select('wtr-question-number')\n    adrQuestionNumberElement.setAttribute('hidden', true)\n    let adrLinkToBooksElement = select('wtr-see-books')\n    adrLinkToBooksElement.removeAttribute('hidden')\n  }\n}\n","/**\n * Get element by id\n * Elements that were already requested are registered in \"selectors\" array for performance\n */\nexport function select(id) {\n  let selector = window.selectors[id]\n  if (!selector) {\n    selector = document.getElementById(id)\n    window.selectors.id = selector\n  }\n  return selector\n}\n\n/**\n * Add or remove the class \"toggleClass\" on all given selectors\n */\nexport function toggleClass(selectors, toggleClass, isAdd) {\n  selectors.forEach((id) => {\n    if (isAdd) {\n      select(id).classList.add(toggleClass)\n    } else {\n      select(id).classList.remove(toggleClass)\n    }\n  })\n}\n\n/**\n * Return the part of the URL corresponding to location hash according to current values,\n * designed to work only when called on books page\n */\nexport function getURL() {\n  return `#${window.baseURL}?${window.sortingParam}`\n}","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"liO3X\\\":\\\"index.d88e7b50.js\\\",\\\"gbcXk\\\":\\\"style.e5948fae.css\\\",\\\"hwmB9\\\":\\\"background.0a8f6521.jpg\\\",\\\"cx3w5\\\":\\\"artwork-suzuha.22f78bed.jpg\\\",\\\"aroW2\\\":\\\"artwork-ede.bf6f015e.png\\\",\\\"ilpGW\\\":\\\"cover-renaissance-s4-1024.1780a789.png\\\",\\\"6Vjqf\\\":\\\"artwork-statue-chateau-s4.e8f883b3.png\\\",\\\"gR7QX\\\":\\\"artwork-lecture-s4.e6252b68.png\\\"}\"));","module.exports = require('./helpers/bundle-url').getBundleURL('liO3X') + require('./helpers/bundle-manifest').resolve(\"gbcXk\");","import styleUrl from \"url:../styles/style.css\";\nimport { updateAnswer } from './utils/what-to-read';\n\nclass AdrQuestion extends HTMLElement {\n\n  static get observedAttributes() {\n    return ['question']\n  }\n\n  attributeChangedCallback(_, oldValue, newValue) {\n    // Remove the listeners of the old question\n    if (oldValue !== null) {\n      this.removeQuestionListeners()\n    }\n    // Get the new question structure from the stringified attribute\n    let question = JSON.parse(newValue)\n    // Show the new question in the DOM\n    this.showQuestion(question)\n    // Add the listeners of the new question\n    this.addQuestionListeners()\n  }\n\n  disconnectedCallback() {\n    this.removeQuestionListeners()\n  }\n\n  constructor() {\n    super()\n    this.wrapper = document.createElement('div')\n    var shadow = this.attachShadow({mode: 'closed'})\n    shadow.innerHTML = `\n      <link rel=\"stylesheet\" href=\"https://unpkg.com/purecss@1.0.0/build/pure-min.css\">\n      <link rel=\"stylesheet\" type=\"text/css\" href=\"${styleUrl}\">\n    `\n    shadow.appendChild(this.wrapper)\n  }\n\n  addQuestionListeners() {\n    let answersElements = this.wrapper.querySelectorAll('[name]')\n    answersElements.forEach((element) => {\n      element.addEventListener('change', this.selectAnswer)\n    })\n  }\n\n  removeQuestionListeners() {\n    let answersElements = this.wrapper.querySelectorAll('[name]')\n    answersElements.forEach((element) => {\n      element.removeEventListener('change', this.selectAnswer)\n    })\n  }\n\n  selectAnswer(event) {\n    updateAnswer(event.target.value)\n  }\n\n  showQuestion(question) {\n    let answers = ''\n    let first = true\n    let checked = ' checked'\n    question.choices.forEach((choice) => {\n      answers += `\n        <div>\n          <input type=\"radio\" id=\"${choice.id}\" name=\"question\" value=\"${choice.id}\"${checked}>\n          <label for=\"${choice.id}\">${choice.label}</label>\n        </div>\n      `\n      if (first) {\n        first = false\n        checked = ''\n      }\n    })\n    this.wrapper.innerHTML = `\n      <p>${question.label}</p>\n      ${answers}\n    `\n  }\n}\n\ncustomElements.define('adr-question', AdrQuestion)\n\n"],"names":["$0c335f126f71bcfc$var$questions","id","label","choices","score","suzuha","ede","vdy","$0c335f126f71bcfc$export$f99a8a4804d97169","window","questions","sort","Math","random","$jYHEd","select","setAttribute","length","$0c335f126f71bcfc$var$_showQuestion","addEventListener","$0c335f126f71bcfc$var$_nextQuestion","$0c335f126f71bcfc$export$63e15e612a739edb","value","selectedAnswer","$0c335f126f71bcfc$var$_computeTmpScore","$0c335f126f71bcfc$var$_getQuestion","questionIndex","undefined","questionScore","find","param","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Object","entries","tmpScore","Symbol","iterator","next","done","key","$kAkBg","slicedToArray","err","return","JSON","stringify","assign","objectSpread","innerHTML","removeAttribute","$e8b57a6fb9383744$export$2e6c959c16ff56b8","selector","selectors","document","getElementById","$e8b57a6fb9383744$export$4a80062ca50b57c7","isAdd","forEach","classList","add","remove","$e8b57a6fb9383744$export$152462a4e1ffe278","concat","baseURL","sortingParam","parcelRequire","register","parse","$71201dc8a607e595$exports","getBundleURL","resolve","$24cc7540123f4ea9$var$AdrQuestion","HTMLElement","wrapper","createElement","shadow","_this","attachShadow","mode","$parcel$interopDefault","appendChild","_","oldValue","newValue","this","removeQuestionListeners","question","showQuestion","addQuestionListeners","querySelectorAll","element","selectAnswer","removeEventListener","event","$12Wwg","updateAnswer","target","answers","first","checked","choice","customElements","define"],"version":3,"file":"index.d88e7b50.js.map"}