{"mappings":"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","sources":["js/utils/what-to-read.js","js/utils/generics.js","node_modules/@parcel/runtime-js/lib/runtime-1e5c69a489bc0651.js","node_modules/@parcel/runtime-js/lib/runtime-c0665e2809cfadba.js","js/adr-question.js"],"sourcesContent":["import { select } from './generics'\n\nconst questions = [{\n  id: 'size',\n  label: 'Plutôt roman court ou roman plus long ?',\n  choices: [{\n    id: 'short',\n    label: 'Plutôt court.',\n    score: { suzuha: 3, ede: 0, vdy: 0 }\n  }, {\n    id: 'long',\n    label: 'Histoire qui dure.',\n    score: { suzuha: 0, ede: 2, vdy: 2 }\n  }, {\n    id: 'no-size-preference',\n    label: 'C\\'est pas la taille qui compte.',\n    score: { suzuha: 0, ede: 0, vdy: 0 }\n  }]\n}, {\n  id: 'pace',\n  label: 'Quel rythme de lecture recherchez-vous ? Êtes-vous dans l\\'action ou dans la contemplation ?',\n  choices: [{\n    id: 'fast',\n    label: 'J\\'aime quand les événements s\\'enchainent rapidement.',\n    score: { suzuha: 3, ede: 3, vdy: 1 }\n  }, {\n    id: 'slow',\n    label: 'Je veux m\\'imprégner de l\\'ambiance avec de belles descriptions.',\n    score: { suzuha: 1, ede: 2, vdy: 3 }\n  }, {\n    id: 'middle',\n    label: 'Tout est dans l\\'équilibre.',\n    score: { suzuha: 1, ede: 3, vdy: 2 }\n  }]\n}, {\n  id: 'time',\n  label: 'Quel temps de narration préférez-vous ?',\n  choices: [{\n    id: 'present',\n    label: 'Présent',\n    score: { suzuha: 3, ede: 3, vdy: 0 }\n  }, {\n    id: 'past',\n    label: 'Passé',\n    score: { suzuha: 0, ede: 0, vdy: 3 }\n  }, {\n    id: 'no-time-preference',\n    label: 'Aucune importance, tant que le style m\\'emporte.',\n    score: { suzuha: 0, ede: 0, vdy: 0 }\n  }]\n}, {\n  id: 'affinity',\n  label: 'Y a-t-il un élément du cercle de la magie qui vous inspire particulièrement ?',\n  choices: [{\n    id: 'water',\n    label: 'Eau',\n    score: { suzuha: 3, ede: 2, vdy: 0 }\n  }, {\n    id: 'light',\n    label: 'Lumière',\n    score: { suzuha: 0, ede: 3, vdy: 3 }\n  }, {\n    id: 'darkness',\n    label: 'Ombre',\n    score: { suzuha: 0, ede: 3, vdy: 0 }\n  }]\n}, {\n  id: 'theme',\n  label: 'Parmi les thématiques suivantes, laquelle vous parle le plus ?',\n  choices: [{\n    id: 'feminism',\n    label: 'Féminisme',\n    score: { suzuha: 3, ede: 1, vdy: 1 }\n  }, {\n    id: 'journey',\n    label: 'Voyage',\n    score: { suzuha: 1, ede: 3, vdy: 1 }\n  }, {\n    id: 'culture-shock',\n    label: 'Choc des cultures',\n    score: { suzuha: 1, ede: 2, vdy: 3 }\n  }]\n}, {\n  id: 'character',\n  label: 'Quel genre de personnage avez-vous envie de suivre ?',\n  choices: [{\n    id: 'heros',\n    label: 'Une héroïne dans la pure tradition, gentille, courageuse et travailleuse.',\n    score: { suzuha: 3, ede: 0, vdy: 0 }\n  }, {\n    id: 'dark-man',\n    label: 'Un jeune homme qui a ses défauts et un lourd passé.',\n    score: { suzuha: 0, ede: 1, vdy: 3 }\n  }, {\n    id: 'duo',\n    label: 'Et pourquoi pas deux personnages dont les chemins vont se croiser ?',\n    score: { suzuha: 0, ede: 3, vdy: 0 }\n  }]\n}, {\n  id: 'pet',\n  label: 'Le compagnon idéal du rôdeur qui est en vous ?',\n  choices: [{\n    id: 'squirrel',\n    label: 'Un écureuil',\n    score: { suzuha: 0, ede: 3, vdy: 0 }\n  }, {\n    id: 'dragon-tiger',\n    label: 'Un GROS félin',\n    score: { suzuha: 3, ede: 0, vdy: 0 }\n  }, {\n    id: 'no-animal',\n    label: 'Je préfère les arbres aux animaux.',\n    score: { suzuha: 0, ede: 0, vdy: 3 }\n  }]\n}]\n\nexport function setupQuestions() {\n  // Set up the list of questions in a random order\n  window.questions = questions.sort(() => Math.random() - 0.5);\n  let adrQuestionNumberElement = select('wtr-question-number')\n  adrQuestionNumberElement.setAttribute('questions-length', window.questions.length)\n  // Initialize the current question\n  _showQuestion()\n  // Bind the next question function to the next question button's click\n  let nextQuestionButton = select('wtr-button-next')\n  nextQuestionButton.addEventListener('click', _nextQuestion)\n}\n\nexport function updateAnswer(value) {\n  window.selectedAnswer = value \n  _computeTmpScore()\n}\n\n/*\n * Return the structure of the current question, based on \"window.questionIndex\"\n */\nfunction _getQuestion() {\n  return window.questionIndex < window.questions.length \n    ? window.questions[window.questionIndex]\n    : undefined\n}\n\n/*\n * Update the temporay score \"window.tmpScore\".\n * It is the sum of the actual score and the current question score.\n * It should be updated each time the selected answer changes.\n */\nfunction _computeTmpScore() {\n  // Compute the temporary score from actual score and current question\n  let questionScore = _getQuestion().choices.find(({ id }) => {\n    return id === window.selectedAnswer\n  }).score\n  for (let [key] of Object.entries(window.tmpScore)) {\n    window.tmpScore[key] = window.score[key] + questionScore[key]\n  }\n  // Update the result list order\n  let resultListElement = select('wtr-result')\n  resultListElement.setAttribute('score', JSON.stringify(window.tmpScore))\n}\n\n/*\n * Update the question component attributes to display the current question.\n */\nfunction _showQuestion() {\n  // Initialize the selected answer and the temporary score \n  window.selectedAnswer = _getQuestion().choices[0].id\n  _computeTmpScore()\n  // Select the question component in the DOM\n  let adrQuestionElement = select('wtr-question')\n  // It needs the question structure\n  adrQuestionElement.setAttribute('question', JSON.stringify(_getQuestion()))\n  // Display the question number\n  let adrQuestionNumberElement = select('wtr-question-number')\n  adrQuestionNumberElement.setAttribute('question-index', window.questionIndex+1)\n}\n\nfunction _nextQuestion() {\n  // Finalize current score\n  Object.assign(window.score, { ...window.tmpScore })\n  // Show next question\n  window.questionIndex++\n  if (_getQuestion()) {\n    _showQuestion()\n  }\n  // If the last question is reached, change the button text, then hide all\n  if (window.questionIndex === window.questions.length-1) {\n    let nextQuestionButton = select('wtr-button-next')\n    nextQuestionButton.innerHTML = 'Valider'\n  } else if (window.questionIndex === window.questions.length) {\n    let nextQuestionButton = select('wtr-button-next')\n    nextQuestionButton.setAttribute('hidden', true)\n    let adrQuestionElement = select('wtr-question')\n    adrQuestionElement.setAttribute('hidden', true)\n    let adrQuestionNumberElement = select('wtr-question-number')\n    adrQuestionNumberElement.setAttribute('hidden', true)\n    let adrLinkToBooksElement = select('wtr-see-books')\n    adrLinkToBooksElement.removeAttribute('hidden')\n  }\n}\n","/**\n * Get element by id\n * Elements that were already requested are registered in \"selectors\" array for performance\n */\nexport function select(id) {\n  let selector = window.selectors[id]\n  if (!selector) {\n    selector = document.getElementById(id)\n    window.selectors.id = selector\n  }\n  return selector\n}\n\n/**\n * Add or remove the class \"toggleClass\" on all given selectors\n */\nexport function toggleClass(selectors, toggleClass, isAdd) {\n  selectors.forEach((id) => {\n    if (isAdd) {\n      select(id).classList.add(toggleClass)\n    } else {\n      select(id).classList.remove(toggleClass)\n    }\n  })\n}\n\n/**\n * Return the part of the URL corresponding to location hash according to current values,\n * designed to work only when called on books page\n */\nexport function getURL() {\n  return `#${window.baseURL}?${window.sortingParam}`\n}","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"6jiUl\\\":\\\"index.c48af83a.js\\\",\\\"gbcXk\\\":\\\"style.e5948fae.css\\\",\\\"hwmB9\\\":\\\"background.0a8f6521.jpg\\\",\\\"cx3w5\\\":\\\"artwork-suzuha.22f78bed.jpg\\\",\\\"aroW2\\\":\\\"artwork-ede.bf6f015e.png\\\",\\\"ilpGW\\\":\\\"cover-renaissance-s4-1024.1780a789.png\\\",\\\"6Vjqf\\\":\\\"artwork-statue-chateau-s4.e8f883b3.png\\\",\\\"gR7QX\\\":\\\"artwork-lecture-s4.e6252b68.png\\\"}\"));","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"gbcXk\")).toString();","import styleUrl from \"url:../styles/style.css\";\nimport { updateAnswer } from './utils/what-to-read';\n\nclass AdrQuestion extends HTMLElement {\n\n  static get observedAttributes() {\n    return ['question']\n  }\n\n  attributeChangedCallback(_, oldValue, newValue) {\n    // Remove the listeners of the old question\n    if (oldValue !== null) {\n      this.removeQuestionListeners()\n    }\n    // Get the new question structure from the stringified attribute\n    let question = JSON.parse(newValue)\n    // Show the new question in the DOM\n    this.showQuestion(question)\n    // Add the listeners of the new question\n    this.addQuestionListeners()\n  }\n\n  disconnectedCallback() {\n    this.removeQuestionListeners()\n  }\n\n  constructor() {\n    super()\n    this.wrapper = document.createElement('div')\n    var shadow = this.attachShadow({mode: 'closed'})\n    shadow.innerHTML = `\n      <link rel=\"stylesheet\" href=\"https://unpkg.com/purecss@1.0.0/build/pure-min.css\">\n      <link rel=\"stylesheet\" type=\"text/css\" href=\"${styleUrl}\">\n    `\n    shadow.appendChild(this.wrapper)\n  }\n\n  addQuestionListeners() {\n    let answersElements = this.wrapper.querySelectorAll('[name]')\n    answersElements.forEach((element) => {\n      element.addEventListener('change', this.selectAnswer)\n    })\n  }\n\n  removeQuestionListeners() {\n    let answersElements = this.wrapper.querySelectorAll('[name]')\n    answersElements.forEach((element) => {\n      element.removeEventListener('change', this.selectAnswer)\n    })\n  }\n\n  selectAnswer(event) {\n    updateAnswer(event.target.value)\n  }\n\n  showQuestion(question) {\n    let answers = ''\n    let first = true\n    let checked = ' checked'\n    question.choices.forEach((choice) => {\n      answers += `\n        <div>\n          <input type=\"radio\" id=\"${choice.id}\" name=\"question\" value=\"${choice.id}\"${checked}>\n          <label for=\"${choice.id}\">${choice.label}</label>\n        </div>\n      `\n      if (first) {\n        first = false\n        checked = ''\n      }\n    })\n    this.wrapper.innerHTML = `\n      <p>${question.label}</p>\n      ${answers}\n    `\n  }\n}\n\ncustomElements.define('adr-question', AdrQuestion)\n\n"],"names":["$00793759aed0d84a$var$questions","id","label","choices","score","suzuha","ede","vdy","$00793759aed0d84a$export$f99a8a4804d97169","window","questions","sort","Math","random","$91BTG","select","setAttribute","length","$00793759aed0d84a$var$_showQuestion","addEventListener","$00793759aed0d84a$var$_nextQuestion","$00793759aed0d84a$export$63e15e612a739edb","value","selectedAnswer","$00793759aed0d84a$var$_computeTmpScore","$00793759aed0d84a$var$_getQuestion","questionIndex","undefined","questionScore","find","key","Object","entries","tmpScore","JSON","stringify","assign","innerHTML","removeAttribute","$69219aa09244bc38$export$2e6c959c16ff56b8","selector","selectors","document","getElementById","$69219aa09244bc38$export$4a80062ca50b57c7","isAdd","forEach","classList","add","remove","$69219aa09244bc38$export$152462a4e1ffe278","baseURL","sortingParam","parcelRequire","register","parse","$7c2b628dc2e2d7cd$exports","URL","resolve","import","meta","url","toString","$f953e6cdb05b9746$var$AdrQuestion","HTMLElement","observedAttributes","attributeChangedCallback","_","oldValue","newValue","this","removeQuestionListeners","question","showQuestion","addQuestionListeners","disconnectedCallback","wrapper","querySelectorAll","element","selectAnswer","removeEventListener","event","$02wgx","updateAnswer","target","answers","first","checked","choice","super","createElement","shadow","attachShadow","mode","$parcel$interopDefault","appendChild","customElements","define"],"version":3,"file":"index.c48af83a.js.map"}